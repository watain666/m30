(function(){"use strict";document.addEventListener("DOMContentLoaded",function(){t()});function t(){const e=document.querySelectorAll("audio");e.forEach(function(e){e.addEventListener("error",function(){console.warn("Audio loading failed for:",e.src),n(e)});const t=e.querySelectorAll("source");t.forEach(function(t){t.addEventListener("error",function(){console.warn("Audio source loading failed for:",t.src),s(t,e)})})})}function n(t){const n=t.querySelectorAll("source");n.forEach(function(t){const n=t.src;if(n&&!t.dataset.retried){t.dataset.retried="true";const s=e(n);s!==n&&(console.log("Retrying with fixed URL:",s),t.src=s)}}),t.load()}function s(t,n){const s=t.src;if(s&&!t.dataset.retried){t.dataset.retried="true";const o=e(s);o!==s&&(console.log("Retrying source with fixed URL:",o),t.src=o,n.load())}}function e(e){try{let t=decodeURIComponent(e);t.includes("%")&&(t=decodeURIComponent(t));const n=t.split("/"),s=n.map(function(e,t){return t<3?e:encodeURIComponent(e)});return s.join("/")}catch(t){return console.warn("Failed to fix URL encoding for:",e,t),e}}function o(){const e=document.querySelectorAll("audio");e.forEach(function(e){e.textContent.trim()||(e.innerHTML="瀏覽器不支援音檔播放或檔案載入失敗。")})}document.addEventListener("DOMContentLoaded",o)})()