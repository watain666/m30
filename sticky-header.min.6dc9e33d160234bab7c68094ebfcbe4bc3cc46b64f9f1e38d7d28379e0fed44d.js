(function(){let t=!1,o=null;function e(){if(window.innerWidth>768)return;const e=document.querySelector(".book-header");if(!e)return;let n=!1,s=!1;function o(){const o=window.scrollY,t=o>10;t!==n&&(n=t,n?e.classList.add("sticky-active"):e.classList.remove("sticky-active")),s=!1}function i(){s||(requestAnimationFrame(o),s=!0)}window.addEventListener("scroll",i,{passive:!0}),document.querySelectorAll('label[for="menu-control"], label[for="toc-control"]').forEach(function(e){e.addEventListener("click",function(t){const o=e.getAttribute("for"),n=document.getElementById(o);if(o==="toc-control"){t.preventDefault(),n&&(n.checked=!n.checked);return}const s=window.scrollY;t.preventDefault(),n&&(n.checked=!n.checked),setTimeout(function(){window.scrollTo(0,s)},10),setTimeout(function(){window.scrollY!==s&&window.scrollTo(0,s)},50)})}),o(),t=!0}function n(){function e(e){const s=e.target.closest('a[href^="#"]');if(!s)return;const t=s.getAttribute("href");if(!t||t==="#")return;e.preventDefault();const i=t.substring(1),n=document.getElementById(i);if(n){o=n;const e=document.getElementById("toc-control");e&&e.checked&&(e.checked=!1);const i=window.innerWidth<=768;let s=0;if(i){const e=document.querySelector(".book-header");e?s=e.offsetHeight-50:s=30}const a=n.offsetTop-s;window.scrollTo({top:Math.max(0,a),behavior:"smooth"}),history.replaceState(null,null,t)}}function t(){const t=document.querySelectorAll(".book-toc, .book-header aside");t.forEach(t=>{t.addEventListener("click",e)})}t()}function s(){const e=document.getElementById("toc-control"),t=document.querySelector(".book-toc"),n=document.querySelector('label[for="toc-control"]'),s=document.querySelector(".book-header aside"),o=document.querySelector(".book-toc-overlay");if(!e)return;function i(){e.checked=!1}document.addEventListener("click",function(a){if(!e.checked)return;const r=a.target,c=t&&t.contains(r)||s&&s.contains(r),l=n&&n.contains(r),d=o&&o.contains(r);(!c&&!l||d)&&i()}),document.addEventListener("keydown",function(t){t.key==="Escape"&&e.checked&&(i(),t.preventDefault())})}function i(){window.innerWidth<=768&&!t&&e()}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",function(){n(),s(),e()}):(n(),s(),e()),window.addEventListener("resize",i)})()